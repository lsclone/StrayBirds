---
layout: post
title: IOS开发随笔
category: 技术
---

####1. iOS音视频相关

*参考文档：*

* [iOS开发系列--音频播放、录音、视频播放、拍照、视频录制](http://www.cnblogs.com/kenshincui/p/4186022.html#audio "ios")
* [AVFoundation和 GPUImage初探](http://vonglo.me/2014/08/24/AVFoundation%E5%92%8C-GPUImage%E5%88%9D%E6%8E%A2/ "ios")
* [iOS 获取视频的任意一帧](http://blog.txx.im/blog/2013/09/04/ios-avassertimagegenerator/ "ios")
* [ios 获取录像时长](http://blog.sina.com.cn/s/blog_6d01cce30101dgy7.html "ios")

*参考代码：* [VideoEditing](https://github.com/lsclone/VideoEditing "ios")

####2. UIGestureRecognizer(手势操作)

```
UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc]
                                         initWithTarget:self action:@selector(action:)];
imageView.userInteractionEnabled = YES;
[imageView addGestureRecognizer:tapRecognizer];

-(void) action:(id)sender {
  UITapGestureRecognizer *tapRecognizer = (UITapGestureRecognizer *)sender;
  // tapRecognizer.view ...
}
```

*参考文档：* 

* [ios的手势操作之UIGestureRecognizer浅析](http://blog.csdn.net/daiyibo123/article/details/43370419 "ios")
* [iphone练习之手势识别(双击、捏、旋转、拖动、划动、长按）](http://blog.csdn.net/rhljiayou/article/details/7553927 "ios")

####3. 网络编程

文件上传(多文件):

```
#define kUrl @"http://192.168.1.208/FileUpload.aspx"
#define kBOUNDARY_STRING @"lsclone"

#pragma mark 取得mime types
-(NSString *)getMIMETypes:(NSString *)fileName{
    return @"image/jpg";
}

#pragma mark 取得数据体
-(NSData *)getHttpBody:(NSString *)fileName{
    NSMutableData *dataM=[NSMutableData data];
    NSString *strTop=[NSString stringWithFormat:@"--%@\nContent-Disposition: form-data; name=\"images\"; filename=\"%@\"\nContent-Type: %@\n\n",kBOUNDARY_STRING,fileName,[self getMIMETypes:fileName]];
    NSString *strBottom = [NSString stringWithFormat:@"\n"];
    NSString *filePath=[[NSBundle mainBundle] pathForResource:fileName ofType:nil];
    NSData *fileData=[NSData dataWithContentsOfFile:filePath];
    [dataM appendData:[strTop dataUsingEncoding:NSUTF8StringEncoding]];
    [dataM appendData:fileData];
    [dataM appendData:[strBottom dataUsingEncoding:NSUTF8StringEncoding]];
    return dataM;
}

#pragma mark 上传文件
-(void)uploadFile:(NSArray*)nameArray {
    NSURL *url = [NSURL URLWithString:kUrl];
    NSMutableURLRequest *request= [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:5.0f];
    
    request.HTTPMethod=@"POST";
    
    NSMutableData *data = [NSMutableData data];
    for(int i=0; i<[nameArray count]; i++) {
        [data appendData:[self getHttpBody:(NSString*)nameArray[i]]];
    }
    NSString *strBottom = [NSString stringWithFormat:@"--%@--", kBOUNDARY_STRING];
    [data appendData:[strBottom dataUsingEncoding:NSUTF8StringEncoding]];
    
    //通过请求头设置
    [request setValue:[NSString stringWithFormat:@"%lu",(unsigned long)data.length] forHTTPHeaderField:@"Content-Length"];
    [request setValue:[NSString stringWithFormat:@"multipart/form-data; boundary=%@",kBOUNDARY_STRING] forHTTPHeaderField:@"Content-Type"];
    
    //设置数据体
    request.HTTPBody=data;

    //发送异步请求
    [NSURLConnection sendAsynchronousRequest:request queue:[[NSOperationQueue alloc]init] completionHandler:^(NSURLResponse *response, NSData *data, NSError *connectionError) {
        if(connectionError){
            NSLog(@"error:%@", connectionError.localizedDescription);
        } else {
            NSError *jsonError = nil;
            id jsonObj = [NSJSONSerialization JSONObjectWithData:data options:0 error:&jsonError];
            if(jsonObj == nil) {
                NSLog(@"Error parsing JSON: %@", jsonError);
            } else {
                if ([jsonObj isKindOfClass:[NSArray class]]) {
                    NSArray *jsonArray = (NSArray *)jsonObj;
                    ...
                } else if([jsonObj isKindOfClass:[NSDictionary class]]) {
                    NSDictionary *jsonDictionary = (NSDictionary *)jsonObj;
                    ...
                }
            }
        }
    }];
}
```

*参考文档：

* [HTTP相关](https://github.com/lsclone/blog/blob/gh-pages/_posts/2016-05-27-http.md "ios")
* [iOS开发系列--网络开发](http://www.cnblogs.com/kenshincui/p/4042190.html "ios")
* [iOS网络编程](http://blog.csdn.net/Crayon_DyS/article/category/1394461 "ios")

####4. 多线程

*参考文档：* [iOS多线程编程：线程同步总结](http://blog.csdn.net/lifengzhong/article/details/7487505 "ios")

####5. 自动布局

*参考文档：*

* [IOS自动布局之Autoresizing](http://blog.csdn.net/yongyinmg/article/details/41422697 "ios")
* [为iPhone6设计自适应布局（一）](http://www.th7.cn/Program/IOS/201410/297355.shtml "ios")
* [ios自适应布局](http://blog.csdn.net/xanxus46/article/details/45424795 "ios")

####6. UIImageView

```
//    //给imageView添加阴影和边框  
//    UIImageView*imgvPhoto = [[UIImageView alloc] init];  
    //添加边框  
    CALayer *layer = [imageView layer];  
    layer.borderColor = [UIColor whiteColor].CGColor;  
    layer.borderWidth = 5.0f;  
    //添加四个边阴影  
    imageView.layer.shadowColor = [UIColor blackColor].CGColor;  
    imageView.layer.shadowOffset = CGSizeMake(0,0);  
    imageView.layer.shadowOpacity = 0.5;  
    imageView.layer.shadowRadius = 10.0;//给imageview添加阴影和边框  
    //添加两个边的阴影  
    imageView.layer.shadowColor = [UIColor blackColor].CGColor;  
    imageView.layer.shadowOffset = CGSizeMake(4,4);  
    imageView.layer.shadowOpacity = 0.5;  
    imageView.layer.shadowRadius=2.0;  
```

*参考网址：* [IOS-UIImageView](http://blog.csdn.net/djxiaoyu_haha/article/details/40348377)

####7. UIScrollView

*参考网址：*

* [UIScrollView学习笔记](http://vit0.com/blog/2013/10/09/ios-zhi-uiscrollview-xue-xi-bi-ji/ "ios")
* [ScrollView详解](http://www.cnblogs.com/iCocos/p/4655757.html "ios")
* [iOS UICollectionView简单使用](http://blog.csdn.net/Apple_app/article/details/38867123 "ios")

####8. 十六进制颜色值转UIColor

```
/*
**  hexColorString:
**  0xffffff or #FFFFFF
 */
+ (UIColor *)colorWithHexString:(NSString *)hexColorString {  
    if ([hexColorString length] < 6) { //长度不合法  
        return [UIColor blackColor];  
    }  
    NSString *tempString = [hexColorString lowercaseString];  
    if ([tempString hasPrefix:@"0x"]) { //检查开头是0x  
        tempString = [tempString substringFromIndex:2];  
    } else if ([tempString hasPrefix:@"#"]) { //检查开头是#  
        tempString = [tempString substringFromIndex:1];  
    }  
    if ([tempString length] != 6) {  
        return [UIColor blackColor];  
    }  
    //分解三种颜色的值  
    NSRange range = NSMakeRange(0, 2);  
    NSString *rString = [tempString substringWithRange:range];  
    range.location = 2;  
    NSString *gString = [tempString substringWithRange:range];  
    range.location = 4;  
    NSString *bString = [tempString substringWithRange:range];  
    //取三种颜色值  
    unsigned int r, g, b;  
    [[NSScanner scannerWithString:rString] scanHexInt:&r];  
    [[NSScanner scannerWithString:gString] scanHexInt:&g];  
    [[NSScanner scannerWithString:bString] scanHexInt:&b];  
    return [UIColor colorWithRed:((float)r / 255.0f)  
                           green:((float)g / 255.0f)  
                            blue:((float)b / 255.0f)  
                           alpha:1.0f];  
} 
```

####9. 获取视频方向

```
+ (NSUInteger)degressFromVideoFileWithURL:(NSURL *)url {
  //根据url创建AVURLAsset
  AVURLAsset *urlAsset = [AVURLAsset assetWithURL:url];
  
  //check video orientation
  UIImageOrientation orient = UIImageOrientationUp;
  NSArray *tracks = [urlAsset tracksWithMediaType:AVMediaTypeVideo];
  if([tracks count] > 0) {
      AVAssetTrack *videoTrack = [tracks objectAtIndex:0];
      CGAffineTransform t = videoTrack.preferredTransform;
      if(t.a == 0 && t.b == 1.0 && t.c == -1.0 && t.d == 0){
          // AVCaptureVideoOrientationPortrait
          orient = UIImageOrientationRight;  // rotate 90 degrees clockwise
      }else if(t.a == 0 && t.b == -1.0 && t.c == 1.0 && t.d == 0){
          // AVCaptureVideoOrientationPortraitUpsideDown
          orient = UIImageOrientationLeft;   // rotate 90 degrees counter clockwise
      }else if(t.a == 1.0 && t.b == 0 && t.c == 0 && t.d == 1.0){
          // AVCaptureVideoOrientationLandscapeRight
          orient = UIImageOrientationUp;     // rotate 0 degrees clockwise
      }else if(t.a == -1.0 && t.b == 0 && t.c == 0 && t.d == -1.0){
          // AVCaptureVideoOrientationLandscapeLeft
          orient = UIImageOrientationDown;   // rotate 180 degrees
      }
  }
}
```

*参考网址：* [获取视频方向](http://www.cnblogs.com/alby/p/4610077.html "ios")

####10. UISlider

```
CGRect frame = CGRectMake(0.0, 219.0, 323.0, 20.0);
UISlider *myslider = [[UISlider alloc] initWithFrame:frame];

[myslider addTarget:self action:@selector(sliderAction:) forControlEvents:UIControlEventValueChanged];
[myslider setBackgroundColor:[UIColor clearColor]];
[myslider setThumbImage: [UIImage imageNamed:@"sliderThumb@2x.png"] forState:UIControlStateNormal];

myslider.minimumValue = 0.0;
myslider.maximumValue = 50.0;
myslider.continuous = YES;
myslider.value = 15.0;
[self.view addSubview:myslider];
```

####11. UINavigationController.navigationBar

```
/* change tint color */
self.navigationController.navigationBar.tintColor = [UIColor redColor];
/* change title color */
self.navigationController.navigationBar.titleTextAttributes = @{NSForegroundColorAttributeName:[UIColor redColor]};
/* set navigationbar background to transparent (alpha 0) */
[[[self.navigationController.navigationBar subviews] objectAtIndex:0] setAlpha:0];
```

*参考网址：

* [How to change text color in navigation bar](http://stackoverflow.com/questions/6805025/objective-c-how-to-change-text-color-in-navigation-bar "ios")
* [动态修改UINavigationBar的背景色](http://tech.glowing.com/cn/change-uinavigationbar-backgroundcolor-dynamically/ "ios")
* [iOS 关于navigationBar的一些：毛玻璃、透明、动态缩放、动态隐藏](http://www.jianshu.com/p/b2585c37e14b "ios")
* [关于设置navigationBar高度的问题](http://blog.csdn.net/zmp1123/article/details/45744137 "ios")
* [自定义NavgationBar返回按钮](http://blog.csdn.net/duxinfeng2010/article/details/10010677 "ios")
